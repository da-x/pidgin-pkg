diff -urN pidgin-2.6.0devel/libpurple/connection.c pidgin-2.6.0devel.new/libpurple/connection.c
--- pidgin-2.6.0devel/libpurple/connection.c	2009-07-09 19:24:06.000000000 -0400
+++ pidgin-2.6.0devel.new/libpurple/connection.c	2009-07-21 14:56:10.747078333 -0400
@@ -42,6 +42,10 @@
 
 #define KEEPALIVE_INTERVAL 30
 
+#include <netinet/in.h>
+#include <arpa/nameser.h>
+#include <resolv.h>
+
 static GList *connections = NULL;
 static GList *connections_connecting = NULL;
 static PurpleConnectionUiOps *connection_ui_ops = NULL;
@@ -161,6 +165,9 @@
 
 	purple_signal_emit(purple_connections_get_handle(), "signing-on", gc);
 
+       /* Re-read resolv.conf and friends in case DNS servers have changed */
+       res_init();
+
 	if (regist)
 	{
 		purple_debug_info("connection", "Registering.  gc = %p\n", gc);
diff -urN pidgin-2.6.0devel/libpurple/network.c pidgin-2.6.0devel.new/libpurple/network.c
--- pidgin-2.6.0devel/libpurple/network.c	2009-07-09 19:24:06.000000000 -0400
+++ pidgin-2.6.0devel.new/libpurple/network.c	2009-07-21 14:56:26.698327302 -0400
@@ -746,8 +746,6 @@
 	switch(state)
 	{
 		case NM_STATE_CONNECTED:
-			/* Call res_init in case DNS servers have changed */
-			res_init();
 			/* update STUN IP in case we it changed (theoretically we could
 			   have gone from IPv4 to IPv6, f.ex. or we were previously
 			   offline */
